class Solution {
    public String findOrder(String[] words) {
        // code here
        Set<Character> set=new HashSet<>();
        for(String w:words){
            for(char c:w.toCharArray()) set.add(c);
        }
        
        
        Map<Character,List<Character>> graph=new HashMap<>();
        Map<Character,Integer> indegree=new HashMap<>();
        
        for(char c:set){
            graph.put(c,new ArrayList<>());
            indegree.put(c,0);
        }
        
        for(int i=0;i<words.length-1;i++){
            String w1=words[i];
            String w2=words[i+1];
            if(w1.length()>w2.length()  && w1.startsWith(w2)){
                return "";
            }
            
            int len=Math.min(w1.length(),w2.length());
            
            for(int j=0;j<len;j++){
                char c1=w1.charAt(j);
                char c2=w2.charAt(j);
                
                if(c1!=c2){
                    graph.get(c1).add(c2);
                    indegree.put(c2,indegree.get(c2)+1);
                    break;
                }
            }
        }
        
        Queue<Character> q=new LinkedList<>();
        
        for(char c:indegree.keySet()){
            if(indegree.get(c)==0) q.offer(c);
        }
        
        StringBuilder ans=new StringBuilder();
        while(!q.isEmpty()){
            char node=q.poll();
            ans.append(node);
            for(char nei:graph.get(node)){
                indegree.put(nei,indegree.get(nei)-1);
                if(indegree.get(nei)==0) q.offer(nei);
            }
        }
        
        if(ans.length()!=set.size()) return "";
        
        return ans.toString();
    }
}
